<?php

use App\Domain\GuildMember\RepositoryInterface\GuildMemberRepositoryInterface;
use App\Domain\GuildMember\ValueObjects\Gender;
use App\Domain\GuildMember\ValueObjects\LoginInfo;
use App\Domain\GuildMember\ValueObjects\MailAddress;
use App\Domain\GuildMember\ValueObjects\PassWord;
use App\Domain\GuildMember\ValueObjects\StudentNumber;
use Tests\SampleGuildMember;

/**
 * Created by PhpStorm.
 * User: user
 * Date: 2017/10/27
 * Time: 15:32
 */

class LoginInfoTest extends \Tests\TestCase
{
    /* @var GuildMemberRepositoryInterface $repo */
    protected $repo;

    public function setUp()
    {
        parent::setUp(); // TODO: Change the autogenerated stub

        $this->repo = app(GuildMemberRepositoryInterface::class);

        $studentNumber = new StudentNumber('B4000');
        $studentName = '新原佑亮';
        $gender = new Gender('male');
        $mailAddress = new MailAddress('B4000@oic.jp');
        $password = new PassWord('Abcdefg1');
        $guildMember = $this->sampleGuildMember([
            SampleGuildMember::studentNumber => $studentNumber,
            SampleGuildMember::studentName => $studentName,
            SampleGuildMember::gender => $gender,
            SampleGuildMember::mailAddress => $mailAddress,
            SampleGuildMember::password => $password,
        ]);

        $this->repo->save($guildMember);
    }


    function testSuccess()
    {
        $mailAddress = new MailAddress('B4000@oic.jp');
        $passWord = new PassWord('Abcdefg1');
        $loginInfo = new LoginInfo($mailAddress, $passWord);
        $this->assertTrue($this->repo->findByLoginInfo($loginInfo) != null);
    }


    function testFail()
    {
        $mailAddress = new MailAddress('B3000@oic.jp');
        $passWord = new PassWord('Abcdefg1');
        $loginInfo = new LoginInfo($mailAddress, $passWord);
        $this->assertTrue($this->repo->findByLoginInfo($loginInfo) == null);
    }
}
